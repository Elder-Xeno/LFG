{% extends 'base.html' %}
{% load static %}
{% block content %}
<div class="profile-header">
  <div class="profile-image-container">
    {% if user_profile.profile_image %}
    <img
      class="profile-image"
      src="{{ user_profile.profile_image }}"
      alt="Profile Image"
    />
    {% else %}
    <img
      class="default-profile-image"
      src="{% static 'css/imgs/default-pic.JPG' %}"
      alt="Default Profile Image"
    />
    {% endif %}
  </div>
  <h1>{{ user_profile.user.username }}</h1>
  {% if user_profile == request.user.profile %}
  <a href="{% url 'edit_profile' %}">Edit Profile</a>
  {% endif %}
</div>

{% if edit_mode %}
<form method="post" enctype="multipart/form-data">
  {% csrf_token %}
  <label for="id_profile_image">Upload Profile Picture:</label>
  <input type="file" name="profile_image" id="id_profile_image" />
  <button type="submit">Upload</button>
</form>

<h2>Platforms:</h2>
{% for platform in user_profile.platforms.all %}
<p>{{ platform.name }}</p>
<a href="{% url 'dissociate_platform' platform.id %}">Remove</a>
{% endfor %}

<h2>Games Collection ({{ games_owned.count }}):</h2>
<div class="row">
  {% for game in games_owned %}
  <div class="col-lg-3 col-md-4 col-sm-6">
    <div class="card">
      <img
        src="https://images.igdb.com/igdb/image/upload/t_thumb/{{ game.cover_id }}.jpg"
        class="card-img-top"
        alt="Game Cover"
      />
      <div class="card-body">
        <h5 class="card-title">
          <a href="{{ game.url }}" target="_blank">{{ game.name }}</a>
        </h5>
        <a href="{% url 'dissociate_game' game.id %}" class="btn btn-danger">Remove</a>
      </div>
    </div>
  </div>
  {% endfor %}
</div>

{% else %}

<h2>Platforms:</h2>
{% for platform in user_profile.platforms.all %}
<h5 class="platform">{{ platform.name }}</h5>
{% endfor %}

<h2>Games Collection ({{ games_owned.count }}):</h2>
<div class="row">
  {% for game in games_owned %}
  <div class="col-lg-3 col-md-4 col-sm-6">
    <div class="card">
      <img
        src="https://images.igdb.com/igdb/image/upload/t_cover_big/{{ game.cover_id }}.jpg"
        class="card-img-top"
        alt="Game Cover"
      />
      <div class="card-body">
        <h5 class="card-title">
          <a href="{{ game.url }}" target="_blank">{{ game.name }}</a>
        </h5>
        <p>Platforms:</p>
          {% for platform in game.platforms.all %}
            {{ platform.name }}
          {% endfor %}
      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% endif %}

{% endblock %}
